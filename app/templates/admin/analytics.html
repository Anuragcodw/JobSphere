{% extends "base.html" %}
{% block content %}

<style>
.analytics-wrapper{
    padding:40px;
    min-height:100vh;
    background:
        radial-gradient(circle at top left, rgba(59,130,246,0.15), transparent 40%),
        radial-gradient(circle at bottom right, rgba(34,197,94,0.15), transparent 40%),
        linear-gradient(180deg,#020617,#000);
    animation:fadeIn .7s ease;
}
@keyframes fadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}

.cards{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:22px;
    margin-bottom:35px;
}
.card{
    background:linear-gradient(180deg,#fff,#f8fafc);
    border-radius:18px;
    padding:22px;
    box-shadow:0 18px 45px rgba(0,0,0,.35);
    transition:.3s ease;
}
.card:hover{
    transform:translateY(-6px) scale(1.03);
    box-shadow:0 30px 70px rgba(0,0,0,.5);
}
.card h5{color:#64748b;font-size:14px}
.card .val{font-size:34px;font-weight:800;color:#020617}

.charts{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
    gap:30px;
}
.chart-box{
    background:#020617;
    border-radius:20px;
    padding:24px;
    box-shadow:0 22px 60px rgba(0,0,0,.75);
    transition:.3s ease;
}
.chart-box:hover{
    transform:translateY(-6px) scale(1.02);
    box-shadow:0 35px 90px rgba(0,0,0,.9);
}
.chart-title{
    color:#e5e7eb;
    font-weight:700;
    margin-bottom:12px;
}
</style>

<div class="analytics-wrapper">
    <h2 style="color:#fff;margin-bottom:25px;">Analytics Overview</h2>

    <!-- Top Stats -->
    <div class="cards">
        <div class="card">
            <h5>Total Users</h5>
            <div class="val">{{ total_users }}</div>
        </div>
        <div class="card">
            <h5>Active Users</h5>
            <div class="val">{{ active_users }}</div>
        </div>
        <div class="card">
            <h5>Total Jobs</h5>
            <div class="val">{{ total_jobs }}</div>
        </div>
    </div>

    <!-- Charts -->
    <div class="charts">
        <div class="chart-box">
            <div class="chart-title">Users Activity (Line Graph)</div>
            <canvas id="usersLine"></canvas>
        </div>

        <div class="chart-box">
            <div class="chart-title">Jobs Status (Bar Graph)</div>
            <canvas id="jobsBar"></canvas>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const usersLine = new Chart(document.getElementById("usersLine"), {
    type: "line",
    data: {
        labels: ["Week 1","Week 2","Week 3","Week 4"],
        datasets: [{
            label: "Users",
            data: [0, {{ total_users//3 }}, {{ total_users//2 }}, {{ total_users }}],
            borderColor: "#38bdf8",
            backgroundColor: "rgba(56,189,248,0.25)",
            fill: true,
            tension: 0.4,
            pointRadius: 5,
            pointHoverRadius: 8
        }]
    },
    options: {
        animation: {
            duration: 1500,
            easing: "easeOutQuart"
        },
        plugins:{
            legend:{display:false}
        },
        scales:{
            x:{ticks:{color:"#cbd5e1"}},
            y:{ticks:{color:"#cbd5e1"}, beginAtZero:true}
        }
    }
});

const jobsBar = new Chart(document.getElementById("jobsBar"), {
    type: "bar",
    data: {
        labels: ["Approved","Pending"],
        datasets: [{
            data: [{{ approved_jobs }}, {{ pending_jobs }}],
            backgroundColor: ["#22c55e","#facc15"],
            borderRadius: 10
        }]
    },
    options: {
        animation: {
            duration: 1200,
            easing: "easeOutBounce"
        },
        plugins:{
            legend:{display:false}
        },
        scales:{
            x:{ticks:{color:"#cbd5e1"}},
            y:{ticks:{color:"#cbd5e1"}, beginAtZero:true}
        }
    }
});
</script>

{% endblock %}
